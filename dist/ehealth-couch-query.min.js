/*! angular-couch-query 12-03-2015 */
!function(){var a=!0,b="_";foldToASCII=function(a){if(null===a)return"";for(var b="",e=0;e<a.length;e++){var f=c(a,e);f&&(b+=128>f?String.fromCharCode(f):d(f))}return b};var c=function(a,b){b=b||0;var c,d,e=a.charCodeAt(b);if(e>=55296&&56319>=e){if(c=e,d=a.charCodeAt(b+1),isNaN(d))throw"High surrogate not followed by low surrogate in fixedCharCodeAt()";return 1024*(c-55296)+(d-56320)+65536}return e>=56320&&57343>=e?!1:e},d=function(c){var d="";switch(c){case 192:case 193:case 194:case 195:case 196:case 197:case 256:case 258:case 260:case 399:case 461:case 478:case 480:case 506:case 512:case 514:case 550:case 570:case 7424:case 7680:case 7840:case 7842:case 7844:case 7846:case 7848:case 7850:case 7852:case 7854:case 7856:case 7858:case 7860:case 7862:case 9398:case 65313:d+="A";break;case 224:case 225:case 226:case 227:case 228:case 229:case 257:case 259:case 261:case 462:case 479:case 481:case 507:case 513:case 515:case 551:case 592:case 601:case 602:case 7567:case 7573:case 7681:case 7834:case 7841:case 7843:case 7845:case 7847:case 7849:case 7851:case 7853:case 7855:case 7857:case 7859:case 7861:case 7863:case 8336:case 8340:case 9424:case 11365:case 11375:case 65345:d+="a";break;case 42802:d+="A",d+="A";break;case 198:case 482:case 508:case 7425:d+="A",d+="E";break;case 42804:d+="A",d+="O";break;case 42806:d+="A",d+="U";break;case 42808:case 42810:d+="A",d+="V";break;case 42812:d+="A",d+="Y";break;case 9372:d+="(",d+="a",d+=")";break;case 42803:d+="a",d+="a";break;case 230:case 483:case 509:case 7426:d+="a",d+="e";break;case 42805:d+="a",d+="o";break;case 42807:d+="a",d+="u";break;case 42809:case 42811:d+="a",d+="v";break;case 42813:d+="a",d+="y";break;case 385:case 386:case 579:case 665:case 7427:case 7682:case 7684:case 7686:case 9399:case 65314:d+="B";break;case 384:case 387:case 595:case 7532:case 7552:case 7683:case 7685:case 7687:case 9425:case 65346:d+="b";break;case 9373:d+="(",d+="b",d+=")";break;case 199:case 262:case 264:case 266:case 268:case 391:case 571:case 663:case 7428:case 7688:case 9400:case 65315:d+="C";break;case 231:case 263:case 265:case 267:case 269:case 392:case 572:case 597:case 7689:case 8580:case 9426:case 42814:case 42815:case 65347:d+="c";break;case 9374:d+="(",d+="c",d+=")";break;case 208:case 270:case 272:case 393:case 394:case 395:case 7429:case 7430:case 7690:case 7692:case 7694:case 7696:case 7698:case 9401:case 42873:case 65316:d+="D";break;case 240:case 271:case 273:case 396:case 545:case 598:case 599:case 7533:case 7553:case 7569:case 7691:case 7693:case 7695:case 7697:case 7699:case 9427:case 42874:case 65348:d+="d";break;case 452:case 497:d+="D",d+="Z";break;case 453:case 498:d+="D",d+="z";break;case 9375:d+="(",d+="d",d+=")";break;case 568:d+="d",d+="b";break;case 454:case 499:case 675:case 677:d+="d",d+="z";break;case 200:case 201:case 202:case 203:case 274:case 276:case 278:case 280:case 282:case 398:case 400:case 516:case 518:case 552:case 582:case 7431:case 7700:case 7702:case 7704:case 7706:case 7708:case 7864:case 7866:case 7868:case 7870:case 7872:case 7874:case 7876:case 7878:case 9402:case 11387:case 65317:d+="E";break;case 232:case 233:case 234:case 235:case 275:case 277:case 279:case 281:case 283:case 477:case 517:case 519:case 553:case 583:case 600:case 603:case 604:case 605:case 606:case 666:case 7432:case 7570:case 7571:case 7572:case 7701:case 7703:case 7705:case 7707:case 7709:case 7865:case 7867:case 7869:case 7871:case 7873:case 7875:case 7877:case 7879:case 8337:case 9428:case 11384:case 65349:d+="e";break;case 9376:d+="(",d+="e",d+=")";break;case 401:case 7710:case 9403:case 42800:case 42875:case 43003:case 65318:d+="F";break;case 402:case 7534:case 7554:case 7711:case 7835:case 9429:case 42876:case 65350:d+="f";break;case 9377:d+="(",d+="f",d+=")";break;case 64256:d+="f",d+="f";break;case 64259:d+="f",d+="f",d+="i";break;case 64260:d+="f",d+="f",d+="l";break;case 64257:d+="f",d+="i";break;case 64258:d+="f",d+="l";break;case 284:case 286:case 288:case 290:case 403:case 484:case 485:case 486:case 487:case 500:case 610:case 667:case 7712:case 9404:case 42877:case 42878:case 65319:d+="G";break;case 285:case 287:case 289:case 291:case 501:case 608:case 609:case 7543:case 7545:case 7555:case 7713:case 9430:case 42879:case 65351:d+="g";break;case 9378:d+="(",d+="g",d+=")";break;case 292:case 294:case 542:case 668:case 7714:case 7716:case 7718:case 7720:case 7722:case 9405:case 11367:case 11381:case 65320:d+="H";break;case 293:case 295:case 543:case 613:case 614:case 686:case 687:case 7715:case 7717:case 7719:case 7721:case 7723:case 7830:case 9431:case 11368:case 11382:case 65352:d+="h";break;case 502:d+="H",d+="V";break;case 9379:d+="(",d+="h",d+=")";break;case 405:d+="h",d+="v";break;case 204:case 205:case 206:case 207:case 296:case 298:case 300:case 302:case 304:case 406:case 407:case 463:case 520:case 522:case 618:case 7547:case 7724:case 7726:case 7880:case 7882:case 9406:case 43006:case 65321:d+="I";break;case 236:case 237:case 238:case 239:case 297:case 299:case 301:case 303:case 305:case 464:case 521:case 523:case 616:case 7433:case 7522:case 7548:case 7574:case 7725:case 7727:case 7881:case 7883:case 8305:case 9432:case 65353:d+="i";break;case 306:d+="I",d+="J";break;case 9380:d+="(",d+="i",d+=")";break;case 307:d+="i",d+="j";break;case 308:case 584:case 7434:case 9407:case 65322:d+="J";break;case 309:case 496:case 567:case 585:case 607:case 644:case 669:case 9433:case 11388:case 65354:d+="j";break;case 9381:d+="(",d+="j",d+=")";break;case 310:case 408:case 488:case 7435:case 7728:case 7730:case 7732:case 9408:case 11369:case 42816:case 42818:case 42820:case 65323:d+="K";break;case 311:case 409:case 489:case 670:case 7556:case 7729:case 7731:case 7733:case 9434:case 11370:case 42817:case 42819:case 42821:case 65355:d+="k";break;case 9382:d+="(",d+="k",d+=")";break;case 313:case 315:case 317:case 319:case 321:case 573:case 671:case 7436:case 7734:case 7736:case 7738:case 7740:case 9409:case 11360:case 11362:case 42822:case 42824:case 42880:case 65324:d+="L";break;case 314:case 316:case 318:case 320:case 322:case 410:case 564:case 619:case 620:case 621:case 7557:case 7735:case 7737:case 7739:case 7741:case 9435:case 11361:case 42823:case 42825:case 42881:case 65356:d+="l";break;case 455:d+="L",d+="J";break;case 7930:d+="L",d+="L";break;case 456:d+="L",d+="j";break;case 9383:d+="(",d+="l",d+=")";break;case 457:d+="l",d+="j";break;case 7931:d+="l",d+="l";break;case 682:d+="l",d+="s";break;case 683:d+="l",d+="z";break;case 412:case 7437:case 7742:case 7744:case 7746:case 9410:case 11374:case 43005:case 43007:case 65325:d+="M";break;case 623:case 624:case 625:case 7535:case 7558:case 7743:case 7745:case 7747:case 9436:case 65357:d+="m";break;case 9384:d+="(",d+="m",d+=")";break;case 209:case 323:case 325:case 327:case 330:case 413:case 504:case 544:case 628:case 7438:case 7748:case 7750:case 7752:case 7754:case 9411:case 65326:d+="N";break;case 241:case 324:case 326:case 328:case 329:case 331:case 414:case 505:case 565:case 626:case 627:case 7536:case 7559:case 7749:case 7751:case 7753:case 7755:case 8319:case 9437:case 65358:d+="n";break;case 458:d+="N",d+="J";break;case 459:d+="N",d+="j";break;case 9385:d+="(",d+="n",d+=")";break;case 460:d+="n",d+="j";break;case 210:case 211:case 212:case 213:case 214:case 216:case 332:case 334:case 336:case 390:case 415:case 416:case 465:case 490:case 492:case 510:case 524:case 526:case 554:case 556:case 558:case 560:case 7439:case 7440:case 7756:case 7758:case 7760:case 7762:case 7884:case 7886:case 7888:case 7890:case 7892:case 7894:case 7896:case 7898:case 7900:case 7902:case 7904:case 7906:case 9412:case 42826:case 42828:case 65327:d+="O";break;case 242:case 243:case 244:case 245:case 246:case 248:case 333:case 335:case 337:case 417:case 466:case 491:case 493:case 511:case 525:case 527:case 555:case 557:case 559:case 561:case 596:case 629:case 7446:case 7447:case 7575:case 7757:case 7759:case 7761:case 7763:case 7885:case 7887:case 7889:case 7891:case 7893:case 7895:case 7897:case 7899:case 7901:case 7903:case 7905:case 7907:case 8338:case 9438:case 11386:case 42827:case 42829:case 65359:d+="o";break;case 338:case 630:d+="O",d+="E";break;case 42830:d+="O",d+="O";break;case 546:case 7445:d+="O",d+="U";break;case 9386:d+="(",d+="o",d+=")";break;case 339:case 7444:d+="o",d+="e";break;case 42831:d+="o",d+="o";break;case 547:d+="o",d+="u";break;case 420:case 7448:case 7764:case 7766:case 9413:case 11363:case 42832:case 42834:case 42836:case 65328:d+="P";break;case 421:case 7537:case 7549:case 7560:case 7765:case 7767:case 9439:case 42833:case 42835:case 42837:case 43004:case 65360:d+="p";break;case 9387:d+="(",d+="p",d+=")";break;case 586:case 9414:case 42838:case 42840:case 65329:d+="Q";break;case 312:case 587:case 672:case 9440:case 42839:case 42841:case 65361:d+="q";break;case 9388:d+="(",d+="q",d+=")";break;case 569:d+="q",d+="p";break;case 340:case 342:case 344:case 528:case 530:case 588:case 640:case 641:case 7449:case 7450:case 7768:case 7770:case 7772:case 7774:case 9415:case 11364:case 42842:case 42882:case 65330:d+="R";break;case 341:case 343:case 345:case 529:case 531:case 589:case 636:case 637:case 638:case 639:case 7523:case 7538:case 7539:case 7561:case 7769:case 7771:case 7773:case 7775:case 9441:case 42843:case 42883:case 65362:d+="r";break;case 9389:d+="(",d+="r",d+=")";break;case 346:case 348:case 350:case 352:case 536:case 7776:case 7778:case 7780:case 7782:case 7784:case 9416:case 42801:case 42885:case 65331:d+="S";break;case 347:case 349:case 351:case 353:case 383:case 537:case 575:case 642:case 7540:case 7562:case 7777:case 7779:case 7781:case 7783:case 7785:case 7836:case 7837:case 9442:case 42884:case 65363:d+="s";break;case 7838:d+="S",d+="S";break;case 9390:d+="(",d+="s",d+=")";break;case 223:d+="s",d+="s";break;case 64262:d+="s",d+="t";break;case 354:case 356:case 358:case 428:case 430:case 538:case 574:case 7451:case 7786:case 7788:case 7790:case 7792:case 9417:case 42886:case 65332:d+="T";break;case 355:case 357:case 359:case 427:case 429:case 539:case 566:case 647:case 648:case 7541:case 7787:case 7789:case 7791:case 7793:case 7831:case 9443:case 11366:case 65364:d+="t";break;case 222:case 42854:d+="T",d+="H";break;case 42792:d+="T",d+="Z";break;case 9391:d+="(",d+="t",d+=")";break;case 680:d+="t",d+="c";break;case 254:case 7546:case 42855:d+="t",d+="h";break;case 678:d+="t",d+="s";break;case 42793:d+="t",d+="z";break;case 217:case 218:case 219:case 220:case 360:case 362:case 364:case 366:case 368:case 370:case 431:case 467:case 469:case 471:case 473:case 475:case 532:case 534:case 580:case 7452:case 7550:case 7794:case 7796:case 7798:case 7800:case 7802:case 7908:case 7910:case 7912:case 7914:case 7916:case 7918:case 7920:case 9418:case 65333:d+="U";break;case 249:case 250:case 251:case 252:case 361:case 363:case 365:case 367:case 369:case 371:case 432:case 468:case 470:case 472:case 474:case 476:case 533:case 535:case 649:case 7524:case 7577:case 7795:case 7797:case 7799:case 7801:case 7803:case 7909:case 7911:case 7913:case 7915:case 7917:case 7919:case 7921:case 9444:case 65365:d+="u";break;case 9392:d+="(",d+="u",d+=")";break;case 7531:d+="u",d+="e";break;case 434:case 581:case 7456:case 7804:case 7806:case 7932:case 9419:case 42846:case 42856:case 65334:d+="V";break;case 651:case 652:case 7525:case 7564:case 7805:case 7807:case 9445:case 11377:case 11380:case 42847:case 65366:d+="v";break;case 42848:d+="V",d+="Y";break;case 9393:d+="(",d+="v",d+=")";break;case 42849:d+="v",d+="y";break;case 372:case 503:case 7457:case 7808:case 7810:case 7812:case 7814:case 7816:case 9420:case 11378:case 65335:d+="W";break;case 373:case 447:case 653:case 7809:case 7811:case 7813:case 7815:case 7817:case 7832:case 9446:case 11379:case 65367:d+="w";break;case 9394:d+="(",d+="w",d+=")";break;case 7818:case 7820:case 9421:case 65336:d+="X";break;case 7565:case 7819:case 7821:case 8339:case 9447:case 65368:d+="x";break;case 9395:d+="(",d+="x",d+=")";break;case 221:case 374:case 376:case 435:case 562:case 590:case 655:case 7822:case 7922:case 7924:case 7926:case 7928:case 7934:case 9422:case 65337:d+="Y";break;case 253:case 255:case 375:case 436:case 563:case 591:case 654:case 7823:case 7833:case 7923:case 7925:case 7927:case 7929:case 7935:case 9448:case 65369:d+="y";break;case 9396:d+="(",d+="y",d+=")";break;case 377:case 379:case 381:case 437:case 540:case 548:case 7458:case 7824:case 7826:case 7828:case 9423:case 11371:case 42850:case 65338:d+="Z";break;case 378:case 380:case 382:case 438:case 541:case 549:case 576:case 656:case 657:case 7542:case 7566:case 7825:case 7827:case 7829:case 9449:case 11372:case 42851:case 65370:d+="z";break;case 9397:d+="(",d+="z",d+=")";break;case 8304:case 8320:case 9450:case 9471:case 65296:d+="0";break;case 185:case 8321:case 9312:case 9461:case 10102:case 10112:case 10122:case 65297:d+="1";break;case 9352:d+="1",d+=".";break;case 9332:d+="(",d+="1",d+=")";break;case 178:case 8322:case 9313:case 9462:case 10103:case 10113:case 10123:case 65298:d+="2";break;case 9353:d+="2",d+=".";break;case 9333:d+="(",d+="2",d+=")";break;case 179:case 8323:case 9314:case 9463:case 10104:case 10114:case 10124:case 65299:d+="3";break;case 9354:d+="3",d+=".";break;case 9334:d+="(",d+="3",d+=")";break;case 8308:case 8324:case 9315:case 9464:case 10105:case 10115:case 10125:case 65300:d+="4";break;case 9355:d+="4",d+=".";break;case 9335:d+="(",d+="4",d+=")";break;case 8309:case 8325:case 9316:case 9465:case 10106:case 10116:case 10126:case 65301:d+="5";break;case 9356:d+="5",d+=".";break;case 9336:d+="(",d+="5",d+=")";break;case 8310:case 8326:case 9317:case 9466:case 10107:case 10117:case 10127:case 65302:d+="6";break;case 9357:d+="6",d+=".";break;case 9337:d+="(",d+="6",d+=")";break;case 8311:case 8327:case 9318:case 9467:case 10108:case 10118:case 10128:case 65303:d+="7";break;case 9358:d+="7",d+=".";break;case 9338:d+="(",d+="7",d+=")";break;case 8312:case 8328:case 9319:case 9468:case 10109:case 10119:case 10129:case 65304:d+="8";break;case 9359:d+="8",d+=".";break;case 9339:d+="(",d+="8",d+=")";break;case 8313:case 8329:case 9320:case 9469:case 10110:case 10120:case 10130:case 65305:d+="9";break;case 9360:d+="9",d+=".";break;case 9340:d+="(",d+="9",d+=")";break;case 9321:case 9470:case 10111:case 10121:case 10131:d+="1",d+="0";break;case 9361:d+="1",d+="0",d+=".";break;case 9341:d+="(",d+="1",d+="0",d+=")";break;case 9322:case 9451:d+="1",d+="1";break;case 9362:d+="1",d+="1",d+=".";break;case 9342:d+="(",d+="1",d+="1",d+=")";break;case 9323:case 9452:d+="1",d+="2";break;case 9363:d+="1",d+="2",d+=".";break;case 9343:d+="(",d+="1",d+="2",d+=")";break;case 9324:case 9453:d+="1",d+="3";break;case 9364:d+="1",d+="3",d+=".";break;case 9344:d+="(",d+="1",d+="3",d+=")";break;case 9325:case 9454:d+="1",d+="4";break;case 9365:d+="1",d+="4",d+=".";break;case 9345:d+="(",d+="1",d+="4",d+=")";break;case 9326:case 9455:d+="1",d+="5";break;case 9366:d+="1",d+="5",d+=".";break;case 9346:d+="(",d+="1",d+="5",d+=")";break;case 9327:case 9456:d+="1",d+="6";break;case 9367:d+="1",d+="6",d+=".";break;case 9347:d+="(",d+="1",d+="6",d+=")";break;case 9328:case 9457:d+="1",d+="7";break;case 9368:d+="1",d+="7",d+=".";break;case 9348:d+="(",d+="1",d+="7",d+=")";break;case 9329:case 9458:d+="1",d+="8";break;case 9369:d+="1",d+="8",d+=".";break;case 9349:d+="(",d+="1",d+="8",d+=")";break;case 9330:case 9459:d+="1",d+="9";break;case 9370:d+="1",d+="9",d+=".";break;case 9350:d+="(",d+="1",d+="9",d+=")";break;case 9331:case 9460:d+="2",d+="0";break;case 9371:d+="2",d+="0",d+=".";break;case 9351:d+="(",d+="2",d+="0",d+=")";break;case 171:case 187:case 8220:case 8221:case 8222:case 8243:case 8246:case 10077:case 10078:case 10094:case 10095:case 65282:d+='"';break;case 8216:case 8217:case 8218:case 8219:case 8242:case 8245:case 8249:case 8250:case 10075:case 10076:case 65287:d+="'";break;case 8208:case 8209:case 8210:case 8211:case 8212:case 8315:case 8331:case 65293:d+="-";break;case 8261:case 10098:case 65339:d+="[";break;case 8262:case 10099:case 65341:d+="]";break;case 8317:case 8333:case 10088:case 10090:case 65288:d+="(";break;case 11816:d+="(",d+="(";break;case 8318:case 8334:case 10089:case 10091:case 65289:d+=")";break;case 11817:d+=")",d+=")";break;case 10092:case 10096:case 65308:d+="<";break;case 10093:case 10097:case 65310:d+=">";break;case 10100:case 65371:d+="{";break;case 10101:case 65373:d+="}";break;case 8314:case 8330:case 65291:d+="+";break;case 8316:case 8332:case 65309:d+="=";break;case 65281:d+="!";break;case 8252:d+="!",d+="!";break;case 8265:d+="!",d+="?";break;case 65283:d+="#";break;case 65284:d+="$";break;case 8274:case 65285:d+="%";break;case 65286:d+="&";break;case 8270:case 65290:d+="*";break;case 65292:d+=",";break;case 65294:d+=".";break;case 8260:case 65295:d+="/";break;case 65306:d+=":";break;case 8271:case 65307:d+=";";break;case 65311:d+="?";break;case 8263:d+="?",d+="?";break;case 8264:d+="?",d+="!";break;case 65312:d+="@";break;case 65340:d+="\\";break;case 8248:case 65342:d+="^";break;case 65343:d+="_";break;case 8275:case 65374:d+="~";break;default:d+=a?b:String.fromCharCode(c)}return d}}(),function(){angular.module("eHealth.couchQuery.config",[]).value("eHealth.couchQuery.config",{debug:!0}),angular.module("eHealth.couchQuery.directives",[]),angular.module("eHealth.couchQuery.filters",[]),angular.module("eHealth.couchQuery.services",[]),angular.module("eHealth.couchQuery",["ngLodash","eHealth.couchQuery.config","eHealth.couchQuery.directives","eHealth.couchQuery.filters","eHealth.couchQuery.services"]),angular.module("eHealth.couchQuery.services").factory("foldToAscii",function(){return function(a){return a?foldToASCII(a):a}}),angular.module("eHealth.couchQuery.services").provider("luceneQueryFactory",function(){var a,b;this.setDb=function(b){a=b},this.setSearchDocument=function(a){b=a},this.$get=["$http","requestPaginatorFactory","foldToAscii",function(c,d,e){function f(f){f=f||{};var g={},h=!1,i=f.fineGrainFields||{},j={runCouchDB:function(b,e,f,g){return angular.extend(b,{include_docs:!0}),e.type="couchdb",d(function(b){return g.params=b,c.get(a+"/_design/frontend/_view/by_contact_createdon",g).then(function(a){return a.data})},b,e)},runCouchDBLucene:function(e,g,h,i){if(angular.extend(e,{q:h,include_docs:!0}),angular.extend(g,{unique:!0}),e.stale="ok",f.sortField){var j=e.descending?"\\":"/";e.sort=angular.isArray(f.sortField)?j+f.sortField.join(","+j):j+f.sortField,delete e.descending}return d(function(d){return i.params=d,c.get(a+"/_fti/_design/"+b,i).then(function(a){return a.data})},e,g)},runElasticsearch:function(a,b,e,g){if(angular.extend(a,{q:e}),angular.extend(b,{unique:!0}),f.sortField){var h=a.descending?"desc":"asc";a.sort=angular.isArray(f.sortField)?f.sortField.join(":"+h+",")+":"+h:f.sortField+":"+h,delete a.descending}return d(function(a){return g.params=a,c.get("http://192.168.59.103:9200/sl-call-centre/_search",g).then(function(a){return a.data})},a,b)}},k={searchField:function(a,b){return g[a]={value:b},(void 0===b||angular.isArray(b)&&!b.length)&&delete g[a],k},searchFieldEitherOr:function(a,b){return Object.keys(b).length?g[a]={type:"eitherOr",value:b}:delete g[a],k},searchFieldNot:function(a,b){function c(a){return a!==b}return a in i?g[a]={value:i[a].filter(c)}:(k.searchField(a,b),g[a].type="not"),k},rangeField:function(a,b,c){return b&&c?g[a]={type:"range",from:b,to:c}:delete g[a],k},clearField:function(a){return delete g[a],k},searchFree:function(a){return h=a,k},clearFree:function(){return h=!1,k},getSearchExpression:function(){var a=Object.keys(g).map(function(a){function b(a,b){angular.isUndefined(b)&&(b=c.value);var d;return d=angular.isArray(b)?"("+b.map(e).map(function(a){return'"'+a+'"'}).join(" OR ")+")":'"'+e(b)+'"',a+":"+d}var c=g[a];switch(c.type){case"not":return"NOT "+b(a);case"eitherOr":var d=Object.keys(c.value).filter(function(a){var b=c.value[a];return angular.isDefined(b)&&(!angular.isArray(b)||b.length>0)}).map(function(a){return b(a,c.value[a])});return d.length?"("+d.join(" OR ")+")":"";case"range":return a+":["+c.from+" TO "+c.to+"]";default:return b(a)}});return h&&a.push(e(h)),a.join(" AND ")},run:function(a,b){a=a||{},b=b||{};var c=k.getSearchExpression(),d={withCredentials:!0};return""===c?(b.searchEngine="couchdb",j.runCouchDB(a,b,c,d)):(b.searchEngine=f.searchEngine||"couchdb-lucene","couchdb-lucene"===b.searchEngine?j.runCouchDBLucene(a,b,c,d):"elasticsearch"===b.searchEngine?j.runElasticsearch(a,b,c,d):void 0)}};return k}return{create:f}}]}),angular.module("eHealth.couchQuery.services").provider("requestPaginatorFactory",function(){var a=20;this.setPageSize=function(b){a=b},this.$get=["lodash","$q",function(b,c){function d(a,c,d,e,f,g){f=f||function(a){return a};var h,i=0;return a.rows?(h=a.rows,i=a.total_rows):a.hits&&(h=a.hits.hits.map(function(a){return a._source}),i=a.hits.total),g.unique&&(h=b.uniq(h,function(a){return a.id||a._id})),e.rows=h.map(f),e.totalRows=i,e.firstIndex=c,e.lastIndex=e.firstIndex+e.rows.length-1,e.hasPrevious=c>0,e.hasNext=c+e.rows.length<e.totalRows,e}function e(b,e,f){e=e||{},f=f||{};var g,h=0,i=f.pageSize||a;e=angular.copy(e);var j={hasPrevious:!1,hasNext:!1,update:function(){var a=h*i;return"elasticsearch"===f.searchEngine?(e.size=i,e.from=a):(e.limit=i,e.skip=a),b(e).then(function(b){return d(b,a,i,j,g,f)})},next:function(){j.lastIndex<j.totalRows&&(h++,j.update())},previous:function(){h>0&&(h--,j.update())},setPageSize:function(a){return i=a,h=0,j.update()},parameters:function(a){return a?(e=a,j.update()):angular.copy(e)},setParameter:function(a,b){return e[a]=b,j.update()},setDescending:function(a){var b=e.descending;if(e.descending=a,a==b)return c.when(j);var d=e.startkey,f=e.endkey;return d&&(e.endkey=d),f&&(e.startkey=f),j.update()},transform:function(a){g=a,j.rows=j.rows.map(a)}};return j.update()}return e.updateResult=d,e}]})}(window,document);